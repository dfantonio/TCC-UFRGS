import math
import numpy as np
import matplotlib.pyplot as plt

valor = [2048, 2125, 2202, 2279, 2356, 2432, 2507, 2582, 2656, 2729, 2802, 2873, 2943, 3012, 3079, 3145,
         3209, 3272, 3333, 3392, 3450, 3505, 3558, 3609, 3658, 3704, 3749, 3790, 3830, 3866, 3901, 3932,
         3961, 3987, 4011, 4031, 4049, 4064, 4076, 4085, 4091, 4095, 4095, 4093, 4088, 4079, 4068, 4054,
         4037, 4018, 3995, 3970, 3942, 3911, 3878, 3842, 3804, 3763, 3719, 3674, 3626, 3575, 3523, 3468,
         3412, 3353, 3293, 3231, 3167, 3101, 3034, 2966, 2896, 2826, 2754, 2681, 2607, 2532, 2457, 2381,
         2305, 2228, 2151, 2074, 1997, 1919, 1843, 1766, 1690, 1614, 1539, 1464, 1391, 1318, 1247, 1176,
         1107, 1039, 973,  908,  845,  783,  723,  665,  609,  555,  504,  454,  407,  362,  319,  279,
         242,  206,  174,  144,  117,  93,   71,   53,   37,   24,   14,   6,    2,    1,    2,    6,
         14,   24,   37,   53,   71,   93,   117,  144,  174,  206,  242,  279,  319,  362,  407,  454,
         504,  555,  609,  665,  723,  783,  845,  908,  973,  1039, 1107, 1176, 1247, 1318, 1391, 1464,
         1539, 1614, 1690, 1766, 1843, 1919, 1997, 2074, 2151, 2228, 2305, 2381, 2457, 2532, 2607, 2681,
         2754, 2826, 2896, 2966, 3034, 3101, 3167, 3231, 3293, 3353, 3412, 3468, 3523, 3575, 3626, 3674,
         3719, 3763, 3804, 3842, 3878, 3911, 3942, 3970, 3995, 4018, 4037, 4054, 4068, 4079, 4088, 4093,
         4095, 4095, 4091, 4085, 4076, 4064, 4049, 4031, 4011, 3987, 3961, 3932, 3901, 3866, 3830, 3790,
         3749, 3704, 3658, 3609, 3558, 3505, 3450, 3392, 3333, 3272, 3209, 3145, 3079, 3012, 2943, 2873,
         2802, 2729, 2656, 2582, 2507, 2432, 2356, 2279, 2202, 2125, 2048, 1971, 1894, 1817, 1740, 1664,
         1589, 1514, 1440, 1367, 1294, 1223, 1153, 1084, 1017, 951,  887,  824,  763,  704,  646,  591,
         538,  487,  438,  392,  347,  306,  266,  230,  195,  164,  135,  109,  85,   65,   47,   32,
         20,   11,   5,    1,    1,    3,    8,    17,   28,   42,   59,   78,   101,  126,  154,  185,
         218,  254,  292,  333,  377,  422,  470,  521,  573,  628,  684,  743,  803,  865,  929,  995,
         1062, 1130, 1200, 1270, 1342, 1415, 1489, 1564, 1639, 1715, 1791, 1868, 1945, 2022, 2099, 2177,
         2253, 2330, 2406, 2482, 2557, 2632, 2705, 2778, 2849, 2920, 2989, 3057, 3123, 3188, 3251, 3313,
         3373, 3431, 3487, 3541, 3592, 3642, 3689, 3734, 3777, 3817, 3854, 3890, 3922, 3952, 3979, 4003,
         4025, 4043, 4059, 4072, 4082, 4090, 4094, 4095, 4094, 4090, 4082, 4072, 4059, 4043, 4025, 4003,
         3979, 3952, 3922, 3890, 3854, 3817, 3777, 3734, 3689, 3642, 3592, 3541, 3487, 3431, 3373, 3313,
         3251, 3188, 3123, 3057, 2989, 2920, 2849, 2778, 2705, 2632, 2557, 2482, 2406, 2330, 2253, 2177,
         2099, 2022, 1945, 1868, 1791, 1715, 1639, 1564, 1489, 1415, 1342, 1270, 1200, 1130, 1062, 995,
         929,  865,  803,  743,  684,  628,  573,  521,  470,  422,  377,  333,  292,  254,  218,  185,
         154,  126,  101,  78,   59,   42,   28,   17,   8,    3,    1,    1,    5,    11,   20,   32,
         47,   65,   85,   109,  135,  164,  195,  230,  266,  306,  347,  392,  438,  487,  538,  591,
         646,  704,  763,  824,  887,  951,  1017, 1084, 1153, 1223, 1294, 1367, 1440, 1514, 1589, 1664,
         1740, 1817, 1894, 1971, 2048, 2125, 2202, 2279, 2356, 2432, 2507, 2582, 2656, 2729, 2802, 2873,
         2943, 3012, 3079, 3145, 3209, 3272, 3333, 3392, 3450, 3505, 3558, 3609, 3658, 3704, 3749, 3790,
         3830, 3866, 3901, 3932, 3961, 3987, 4011, 4031, 4049, 4064, 4076, 4085, 4091, 4095, 4095, 4093,
         4088, 4079, 4068, 4054, 4037, 4018, 3995, 3970, 3942, 3911, 3878, 3842, 3804, 3763, 3719, 3674,
         3626, 3575, 3523, 3468, 3412, 3353, 3293, 3231, 3167, 3101, 3034, 2966, 2896, 2826, 2754, 2681,
         2607, 2532, 2457, 2381, 2305, 2228, 2151, 2074, 1997, 1919, 1843, 1766, 1690, 1614, 1539, 1464,
         1391, 1318, 1247, 1176, 1107, 1039, 973,  908,  845,  783,  723,  665,  609,  555,  504,  454,
         407,  362,  319,  279,  242,  206,  174,  144,  117,  93,   71,   53,   37,   24,   14,   6,
         2,    1,    2,    6,    14,   24,   37,   53,   71,   93,   117,  144,  174,  206,  242,  279,
         319,  362,  407,  454,  504,  555,  609,  665,  723,  783,  845,  908,  973,  1039, 1107, 1176,
         1247, 1318, 1391, 1464, 1539, 1614, 1690, 1766, 1843, 1919, 1997, 2074, 2151, 2228, 2305, 2381,
         2457, 2532, 2607, 2681, 2754, 2826, 2896, 2966, 3034, 3101, 3167, 3231, 3293, 3353, 3412, 3468,
         3523, 3575, 3626, 3674, 3719, 3763, 3804, 3842, 3878, 3911, 3942, 3970, 3995, 4018, 4037, 4054,
         4068, 4079, 4088, 4093, 4095, 4095, 4091, 4085, 4076, 4064, 4049, 4031, 4011, 3987, 3961, 3932,
         3901, 3866, 3830, 3790, 3749, 3704, 3658, 3609, 3558, 3505, 3450, 3392, 3333, 3272, 3209, 3145,
         3079, 3012, 2943, 2873, 2802, 2729, 2656, 2582, 2507, 2432, 2356, 2279, 2202, 2125, 2048, 1971,
         1894, 1817, 1740, 1664, 1589, 1514, 1440, 1367, 1294, 1223, 1153, 1084, 1017, 951,  887,  824,
         763,  704,  646,  591,  538,  487,  438,  392,  347,  306,  266,  230,  195,  164,  135,  109,
         85,   65,   47,   32,   20,   11,   5,    1,    1,    3,    8,    17,   28,   42,   59,   78,
         101,  126,  154,  185,  218,  254,  292,  333,  377,  422,  470,  521,  573,  628,  684,  743,
         803,  865,  929,  995,  1062, 1130, 1200, 1270, 1342, 1415, 1489, 1564, 1639, 1715, 1791, 1868,
         1945, 2022, 2099, 2177, 2253, 2330, 2406, 2482, 2557, 2632, 2705, 2778, 2849, 2920, 2989, 3057,
         3123, 3188, 3251, 3313, 3373, 3431, 3487, 3541, 3592, 3642, 3689, 3734, 3777, 3817, 3854, 3890,
         3922, 3952, 3979, 4003, 4025, 4043, 4059, 4072, 4082, 4090, 4094, 4095, 4094, 4090, 4082, 4072,
         4059, 4043, 4025, 4003, 3979, 3952, 3922, 3890, 3854, 3817, 3777, 3734, 3689, 3642, 3592, 3541,
         3487, 3431, 3373, 3313, 3251, 3188, 3123, 3057, 2989, 2920, 2849, 2778, 2705, 2632, 2557, 2482,
         2406, 2330, 2253, 2177, 2099, 2022, 1945, 1868, 1791, 1715, 1639, 1564, 1489, 1415, 1342, 1270,
         1200, 1130, 1062, 995,  929,  865,  803,  743,  684,  628,  573,  521,  470,  422,  377,  333,
         292,  254,  218,  185,  154,  126,  101,  78,   59,   42,   28,   17,   8,    3,    1,    1,
         5,    11,   20,   32,   47,   65,   85,   109,  135,  164,  195,  230,  266,  306,  347,  392,
         438,  487,  538,  591,  646,  704,  763,  824,  887,  951,  1017, 1084, 1153, 1223, 1294, 1367,
         1440, 1514, 1589, 1664, 1740, 1817, 1894, 1971, 2048, 2125, 2202, 2279, 2356, 2432, 2507, 2582,
         2656, 2729, 2802, 2873, 2943, 3012, 3079, 3145, 3209, 3272, 3333, 3392, 3450, 3505, 3558, 3609,
         3658, 3704, 3749, 3790, 3830, 3866, 3901, 3932, 3961, 3987, 4011, 4031, 4049, 4064, 4076, 4085,
         4091, 4095, 4095, 4093, 4088, 4079, 4068, 4054, 4037, 4018, 3995, 3970, 3942, 3911, 3878, 3842,
         3804, 3763, 3719, 3674, 3626, 3575, 3523, 3468, 3412, 3353, 3293, 3231, 3167, 3101, 3034, 2966,
         2896, 2826, 2754, 2681, 2607, 2532, 2457, 2381, 2305, 2228, 2151, 2074, 1997, 1919, 1843, 1766,
         1690, 1614, 1539, 1464, 1391, 1318, 1247, 1176, 1107, 1039, 973,  908,  845,  783,  723,  665,
         609,  555,  504,  454,  407,  362,  319,  279,  242,  206,  174,  144,  117,  93,   71,   53,
         37,   24,   14,   6,    2,    1,    2,    6,    14,   24,   37,   53,   71,   93,   117,  144,
         174,  206,  242,  279,  319,  362,  407,  454,  504,  555,  609,  665,  723,  783,  845,  908,
         973,  1039, 1107, 1176, 1247, 1318, 1391, 1464, 1539, 1614, 1690, 1766, 1843, 1919, 1997, 2074,
         2151, 2228, 2305, 2381, 2457, 2532, 2607, 2681, 2754, 2826, 2896, 2966, 3034, 3101, 3167, 3231,
         3293, 3353, 3412, 3468, 3523, 3575, 3626, 3674, 3719, 3763, 3804, 3842, 3878, 3911, 3942, 3970,
         3995, 4018, 4037, 4054, 4068, 4079, 4088, 4093, 4095, 4095, 4091, 4085, 4076, 4064, 4049, 4031,
         4011, 3987, 3961, 3932, 3901, 3866, 3830, 3790, 3749, 3704, 3658, 3609, 3558, 3505, 3450, 3392,
         3333, 3272, 3209, 3145, 3079, 3012, 2943, 2873, 2802, 2729, 2656, 2582, 2507, 2432, 2356, 2279,
         2202, 2125, 2048, 1971, 1894, 1817, 1740, 1664, 1589, 1514, 1440, 1367, 1294, 1223, 1153, 1084,
         1017, 951,  887,  824,  763,  704,  646,  591,  538,  487,  438,  392,  347,  306,  266,  230,
         195,  164,  135,  109,  85,   65,   47,   32,   20,   11,   5,    1,    1,    3,    8,    17,
         28,   42,   59,   78,   101,  126,  154,  185,  218,  254,  292,  333,  377,  422,  470,  521,
         573,  628,  684,  743,  803,  865,  929,  995,  1062, 1130, 1200, 1270, 1342, 1415, 1489, 1564,
         1639, 1715, 1791, 1868, 1945, 2022, 2099, 2177, 2253, 2330, 2406, 2482, 2557, 2632, 2705, 2778,
         2849, 2920, 2989, 3057, 3123, 3188, 3251, 3313, 3373, 3431, 3487, 3541, 3592, 3642, 3689, 3734,
         3777, 3817, 3854, 3890, 3922, 3952, 3979, 4003, 4025, 4043, 4059, 4072, 4082, 4090, 4094, 4095,
         4094, 4090, 4082, 4072, 4059, 4043, 4025, 4003, 3979, 3952, 3922, 3890, 3854, 3817, 3777, 3734,
         3689, 3642, 3592, 3541, 3487, 3431, 3373, 3313, 3251, 3188, 3123, 3057, 2989, 2920, 2849, 2778,
         2705, 2632, 2557, 2482, 2406, 2330, 2253, 2177, 2099, 2022, 1945, 1868, 1791, 1715, 1639, 1564,
         1489, 1415, 1342, 1270, 1200, 1130, 1062, 995,  929,  865,  803,  743,  684,  628,  573,  521,
         470,  422,  377,  333,  292,  254,  218,  185,  154,  126,  101,  78,   59,   42,   28,   17,
         8,    3,    1,    1,    5,    11,   20,   32,   47,   65,   85,   109,  135,  164,  195,  230,
         266,  306,  347,  392,  438,  487,  538,  591,  646,  704,  763,  824,  887,  951,  1017, 1084,
         1153, 1223, 1294, 1367, 1440, 1514, 1589, 1664, 1740, 1817, 1894, 1971, 2048, 2125, 2202, 2279,
         2356, 2432, 2507, 2582, 2656, 2729, 2802, 2873, 2943, 3012, 3079, 3145, 3209, 3272, 3333, 3392,
         3450, 3505, 3558, 3609, 3658, 3704, 3749, 3790, 3830, 3866, 3901, 3932, 3961, 3987, 4011, 4031,
         4049, 4064, 4076, 4085, 4091, 4095, 4095, 4093, 4088, 4079, 4068, 4054, 4037, 4018, 3995, 3970,
         3942, 3911, 3878, 3842, 3804, 3763, 3719, 3674, 3626, 3575, 3523, 3468, 3412, 3353, 3293, 3231,
         3167, 3101, 3034, 2966, 2896, 2826, 2754, 2681, 2607, 2532, 2457, 2381, 2305, 2228, 2151, 2074,
         1997, 1919, 1843, 1766, 1690, 1614, 1539, 1464, 1391, 1318, 1247, 1176, 1107, 1039, 973,  908,
         845,  783,  723,  665,  609,  555,  504,  454,  407,  362,  319,  279,  242,  206,  174,  144,
         117,  93,   71,   53,   37,   24,   14,   6,    2,    1,    2,    6,    14,   24,   37,   53,
         71,   93,   117,  144,  174,  206,  242,  279,  319,  362,  407,  454,  504,  555,  609,  665,
         723,  783,  845,  908,  973,  1039, 1107, 1176, 1247, 1318, 1391, 1464, 1539, 1614, 1690, 1766,
         1843, 1919, 1997, 2074, 2151, 2228, 2305, 2381, 2457, 2532, 2607, 2681, 2754, 2826, 2896, 2966,
         3034, 3101, 3167, 3231, 3293, 3353, 3412, 3468, 3523, 3575, 3626, 3674, 3719, 3763, 3804, 3842,
         3878, 3911, 3942, 3970, 3995, 4018, 4037, 4054, 4068, 4079, 4088, 4093, 4095, 4095, 4091, 4085,
         4076, 4064, 4049, 4031, 4011, 3987, 3961, 3932, 3901, 3866, 3830, 3790, 3749, 3704, 3658, 3609,
         3558, 3505, 3450, 3392, 3333, 3272, 3209, 3145, 3079, 3012, 2943, 2873, 2802, 2729, 2656, 2582,
         2507, 2432, 2356, 2279, 2202, 2125, 2048, 1971, 1894, 1817, 1740, 1664, 1589, 1514, 1440, 1367,
         1294, 1223, 1153, 1084, 1017, 951,  887,  824,  763,  704,  646,  591,  538,  487,  438,  392,
         347,  306,  266,  230,  195,  164,  135,  109,  85,   65,   47,   32,   20,   11,   5,    1,
         1,    3,    8,    17,   28,   42,   59,   78,   101,  126,  154,  185,  218,  254,  292,  333,
         377,  422,  470,  521,  573,  628,  684,  743,  803,  865,  929,  995,  1062, 1130, 1200, 1270,
         1342, 1415, 1489, 1564, 1639, 1715, 1791, 1868, 1945, 2022, 2099, 2177, 2253, 2330, 2406, 2482,
         2557, 2632, 2705, 2778, 2849, 2920, 2989, 3057, 3123, 3188, 3251, 3313, 3373, 3431, 3487, 3541,
         3592, 3642, 3689, 3734, 3777, 3817, 3854, 3890, 3922, 3952, 3979, 4003, 4025, 4043, 4059, 4072,
         4082, 4090, 4094, 4095, 4094, 4090, 4082, 4072, 4059, 4043, 4025, 4003, 3979, 3952, 3922, 3890,
         3854, 3817, 3777, 3734, 3689, 3642, 3592, 3541, 3487, 3431, 3373, 3313, 3251, 3188, 3123, 3057,
         2989, 2920, 2849, 2778, 2705, 2632, 2557, 2482, 2406, 2330, 2253, 2177, 2099, 2022, 1945, 1868,
         1791, 1715, 1639, 1564, 1489, 1415, 1342, 1270, 1200, 1130, 1062, 995,  929,  865,  803,  743,
         684,  628,  573,  521,  470,  422,  377,  333,  292,  254,  218,  185,  154,  126,  101,  78,
         59,   42,   28,   17,   8,    3,    1,    1,    5,    11,   20,   32,   47,   65,   85,   109,
         135,  164,  195,  230,  266,  306,  347,  392,  438,  487,  538,  591,  646,  704,  763,  824,
         887,  951,  1017, 1084, 1153, 1223, 1294, 1367, 1440, 1514, 1589, 1664, 1740, 1817, 1894, 1971,

         2048, 2202, 2356, 2507, 2656, 2802, 2943, 3079, 3209, 3333, 3450, 3558, 3658, 3749, 3830, 3901,
         3961, 4011, 4049, 4076, 4091, 4095, 4088, 4068, 4037, 3995, 3942, 3878, 3804, 3719, 3626, 3523,
         3412, 3293, 3167, 3034, 2896, 2754, 2607, 2457, 2305, 2151, 1997, 1843, 1690, 1539, 1391, 1247,
         1107, 973,  845,  723,  609,  504,  407,  319,  242,  174,  117,  71,   37,   14,   2,    2,
         14,   37,   71,   117,  174,  242,  319,  407,  504,  609,  723,  845,  973,  1107, 1247, 1391,
         1539, 1690, 1843, 1997, 2151, 2305, 2457, 2607, 2754, 2896, 3034, 3167, 3293, 3412, 3523, 3626,
         3719, 3804, 3878, 3942, 3995, 4037, 4068, 4088, 4095, 4091, 4076, 4049, 4011, 3961, 3901, 3830,
         3749, 3658, 3558, 3450, 3333, 3209, 3079, 2943, 2802, 2656, 2507, 2356, 2202, 2048, 1894, 1740,
         1589, 1440, 1294, 1153, 1017, 887,  763,  646,  538,  438,  347,  266,  195,  135,  85,   47,
         20,   5,    1,    8,    28,   59,   101,  154,  218,  292,  377,  470,  573,  684,  803,  929,
         1062, 1200, 1342, 1489, 1639, 1791, 1945, 2099, 2253, 2406, 2557, 2705, 2849, 2989, 3123, 3251,
         3373, 3487, 3592, 3689, 3777, 3854, 3922, 3979, 4025, 4059, 4082, 4094, 4094, 4082, 4059, 4025,
         3979, 3922, 3854, 3777, 3689, 3592, 3487, 3373, 3251, 3123, 2989, 2849, 2705, 2557, 2406, 2253,
         2099, 1945, 1791, 1639, 1489, 1342, 1200, 1062, 929,  803,  684,  573,  470,  377,  292,  218,
         154,  101,  59,   28,   8,    1,    5,    20,   47,   85,   135,  195,  266,  347,  438,  538,
         646,  763,  887,  1017, 1153, 1294, 1440, 1589, 1740, 1894, 2048, 2202, 2356, 2507, 2656, 2802,
         2943, 3079, 3209, 3333, 3450, 3558, 3658, 3749, 3830, 3901, 3961, 4011, 4049, 4076, 4091, 4095,
         4088, 4068, 4037, 3995, 3942, 3878, 3804, 3719, 3626, 3523, 3412, 3293, 3167, 3034, 2896, 2754,
         2607, 2457, 2305, 2151, 1997, 1843, 1690, 1539, 1391, 1247, 1107, 973,  845,  723,  609,  504,
         407,  319,  242,  174,  117,  71,   37,   14,   2,    2,    14,   37,   71,   117,  174,  242,
         319,  407,  504,  609,  723,  845,  973,  1107, 1247, 1391, 1539, 1690, 1843, 1997, 2151, 2305,
         2457, 2607, 2754, 2896, 3034, 3167, 3293, 3412, 3523, 3626, 3719, 3804, 3878, 3942, 3995, 4037,
         4068, 4088, 4095, 4091, 4076, 4049, 4011, 3961, 3901, 3830, 3749, 3658, 3558, 3450, 3333, 3209,
         3079, 2943, 2802, 2656, 2507, 2356, 2202, 2048, 1894, 1740, 1589, 1440, 1294, 1153, 1017, 887,
         763,  646,  538,  438,  347,  266,  195,  135,  85,   47,   20,   5,    1,    8,    28,   59,
         101,  154,  218,  292,  377,  470,  573,  684,  803,  929,  1062, 1200, 1342, 1489, 1639, 1791,
         1945, 2099, 2253, 2406, 2557, 2705, 2849, 2989, 3123, 3251, 3373, 3487, 3592, 3689, 3777, 3854,
         3922, 3979, 4025, 4059, 4082, 4094, 4094, 4082, 4059, 4025, 3979, 3922, 3854, 3777, 3689, 3592,
         3487, 3373, 3251, 3123, 2989, 2849, 2705, 2557, 2406, 2253, 2099, 1945, 1791, 1639, 1489, 1342,
         1200, 1062, 929,  803,  684,  573,  470,  377,  292,  218,  154,  101,  59,   28,   8,    1,
         5,    20,   47,   85,   135,  195,  266,  347,  438,  538,  646,  763,  887,  1017, 1153, 1294,
         1440, 1589, 1740, 1894, 2048, 2202, 2356, 2507, 2656, 2802, 2943, 3079, 3209, 3333, 3450, 3558,
         3658, 3749, 3830, 3901, 3961, 4011, 4049, 4076, 4091, 4095, 4088, 4068, 4037, 3995, 3942, 3878,
         3804, 3719, 3626, 3523, 3412, 3293, 3167, 3034, 2896, 2754, 2607, 2457, 2305, 2151, 1997, 1843,
         1690, 1539, 1391, 1247, 1107, 973,  845,  723,  609,  504,  407,  319,  242,  174,  117,  71,
         37,   14,   2,    2,    14,   37,   71,   117,  174,  242,  319,  407,  504,  609,  723,  845,
         973,  1107, 1247, 1391, 1539, 1690, 1843, 1997, 2151, 2305, 2457, 2607, 2754, 2896, 3034, 3167,
         3293, 3412, 3523, 3626, 3719, 3804, 3878, 3942, 3995, 4037, 4068, 4088, 4095, 4091, 4076, 4049,
         4011, 3961, 3901, 3830, 3749, 3658, 3558, 3450, 3333, 3209, 3079, 2943, 2802, 2656, 2507, 2356,
         2202, 2048, 1894, 1740, 1589, 1440, 1294, 1153, 1017, 887,  763,  646,  538,  438,  347,  266,
         195,  135,  85,   47,   20,   5,    1,    8,    28,   59,   101,  154,  218,  292,  377,  470,
         573,  684,  803,  929,  1062, 1200, 1342, 1489, 1639, 1791, 1945, 2099, 2253, 2406, 2557, 2705,
         2849, 2989, 3123, 3251, 3373, 3487, 3592, 3689, 3777, 3854, 3922, 3979, 4025, 4059, 4082, 4094,
         4094, 4082, 4059, 4025, 3979, 3922, 3854, 3777, 3689, 3592, 3487, 3373, 3251, 3123, 2989, 2849,
         2705, 2557, 2406, 2253, 2099, 1945, 1791, 1639, 1489, 1342, 1200, 1062, 929,  803,  684,  573,
         470,  377,  292,  218,  154,  101,  59,   28,   8,    1,    5,    20,   47,   85,   135,  195,
         266,  347,  438,  538,  646,  763,  887,  1017, 1153, 1294, 1440, 1589, 1740, 1894, 2048, 2202,
         2356, 2507, 2656, 2802, 2943, 3079, 3209, 3333, 3450, 3558, 3658, 3749, 3830, 3901, 3961, 4011,
         4049, 4076, 4091, 4095, 4088, 4068, 4037, 3995, 3942, 3878, 3804, 3719, 3626, 3523, 3412, 3293,
         3167, 3034, 2896, 2754, 2607, 2457, 2305, 2151, 1997, 1843, 1690, 1539, 1391, 1247, 1107, 973,
         845,  723,  609,  504,  407,  319,  242,  174,  117,  71,   37,   14,   2,    2,    14,   37,
         71,   117,  174,  242,  319,  407,  504,  609,  723,  845,  973,  1107, 1247, 1391, 1539, 1690,
         1843, 1997, 2151, 2305, 2457, 2607, 2754, 2896, 3034, 3167, 3293, 3412, 3523, 3626, 3719, 3804,
         3878, 3942, 3995, 4037, 4068, 4088, 4095, 4091, 4076, 4049, 4011, 3961, 3901, 3830, 3749, 3658,
         3558, 3450, 3333, 3209, 3079, 2943, 2802, 2656, 2507, 2356, 2202, 2048, 1894, 1740, 1589, 1440,
         1294, 1153, 1017, 887,  763,  646,  538,  438,  347,  266,  195,  135,  85,   47,   20,   5,
         1,    8,    28,   59,   101,  154,  218,  292,  377,  470,  573,  684,  803,  929,  1062, 1200,
         1342, 1489, 1639, 1791, 1945, 2099, 2253, 2406, 2557, 2705, 2849, 2989, 3123, 3251, 3373, 3487,
         3592, 3689, 3777, 3854, 3922, 3979, 4025, 4059, 4082, 4094, 4094, 4082, 4059, 4025, 3979, 3922,
         3854, 3777, 3689, 3592, 3487, 3373, 3251, 3123, 2989, 2849, 2705, 2557, 2406, 2253, 2099, 1945,
         1791, 1639, 1489, 1342, 1200, 1062, 929,  803,  684,  573,  470,  377,  292,  218,  154,  101,
         59,   28,   8,    1,    5,    20,   47,   85,   135,  195,  266,  347,  438,  538,  646,  763,
         887,  1017, 1153, 1294, 1440, 1589, 1740, 1894, 2048, 2202, 2356, 2507, 2656, 2802, 2943, 3079,
         3209, 3333, 3450, 3558, 3658, 3749, 3830, 3901, 3961, 4011, 4049, 4076, 4091, 4095, 4088, 4068,
         4037, 3995, 3942, 3878, 3804, 3719, 3626, 3523, 3412, 3293, 3167, 3034, 2896, 2754, 2607, 2457,
         2305, 2151, 1997, 1843, 1690, 1539, 1391, 1247, 1107, 973,  845,  723,  609,  504,  407,  319,
         242,  174,  117,  71,   37,   14,   2,    2,    14,   37,   71,   117,  174,  242,  319,  407,
         504,  609,  723,  845,  973,  1107, 1247, 1391, 1539, 1690, 1842, 1997, 2151, 2305, 2457, 2607,
         2754, 2896, 3034, 3167, 3293, 3412, 3523, 3626, 3719, 3804, 3878, 3942, 3995, 4037, 4068, 4088,
         4095, 4091, 4076, 4049, 4011, 3961, 3901, 3830, 3749, 3658, 3558, 3450, 3333, 3209, 3079, 2943,
         2802, 2656, 2507, 2356, 2202, 2048, 1894, 1740, 1589, 1440, 1294, 1153, 1017, 887,  763,  646,
         538,  438,  347,  266,  195,  135,  85,   47,   20,   5,    1,    8,    28,   59,   101,  154,
         218,  292,  377,  470,  573,  684,  803,  929,  1062, 1200, 1342, 1489, 1639, 1791, 1945, 2099,
         2253, 2406, 2557, 2705, 2849, 2989, 3123, 3251, 3373, 3487, 3592, 3689, 3777, 3854, 3922, 3979,
         4025, 4059, 4082, 4094, 4094, 4082, 4059, 4025, 3979, 3922, 3854, 3777, 3689, 3592, 3487, 3373,
         3251, 3123, 2989, 2849, 2705, 2557, 2406, 2254, 2099, 1945, 1791, 1639, 1489, 1342, 1200, 1062,
         929,  803,  684,  573,  470,  377,  292,  218,  154,  101,  59,   28,   8,    1,    5,    20,
         47,   85,   135,  195,  266,  347,  438,  538,  646,  763,  887,  1017, 1153, 1294, 1440, 1589,
         1740, 1894, 2048, 2202, 2356, 2507, 2656, 2802, 2943, 3079, 3209, 3333, 3450, 3558, 3658, 3749,
         3830, 3901, 3961, 4011, 4049, 4076, 4091, 4095, 4088, 4068, 4037, 3995, 3942, 3878, 3804, 3719,
         3626, 3523, 3412, 3293, 3167, 3034, 2896, 2754, 2607, 2457, 2305, 2151, 1997, 1843, 1690, 1539,
         1391, 1247, 1107, 973,  845,  723,  609,  504,  407,  319,  242,  174,  117,  71,   37,   14,
         2,    2,    14,   37,   71,   117,  174,  242,  319,  407,  504,  609,  723,  845,  973,  1107,
         1247, 1391, 1539, 1690, 1842, 1997, 2151, 2305, 2457, 2607, 2754, 2896, 3034, 3167, 3293, 3412,
         3523, 3626, 3719, 3804, 3878, 3942, 3995, 4037, 4068, 4088, 4095, 4091, 4076, 4049, 4011, 3961,
         3901, 3830, 3749, 3658, 3558, 3450, 3333, 3209, 3079, 2943, 2802, 2656, 2507, 2356, 2202, 2048,
         1894, 1740, 1589, 1440, 1294, 1153, 1017, 887,  763,  646,  538,  438,  347,  266,  195,  135,
         85,   47,   20,   5,    1,    8,    28,   59,   101,  154,  218,  292,  377,  470,  573,  684,
         803,  929,  1062, 1200, 1342, 1489, 1639, 1791, 1945, 2099, 2253, 2406, 2557, 2705, 2849, 2989,
         3123, 3251, 3373, 3487, 3592, 3689, 3777, 3854, 3922, 3979, 4025, 4059, 4082, 4094, 4094, 4082,
         4059, 4025, 3979, 3922, 3854, 3777, 3689, 3592, 3487, 3373, 3251, 3123, 2989, 2849, 2705, 2557,
         2406, 2254, 2099, 1945, 1791, 1639, 1489, 1342, 1200, 1062, 929,  803,  684,  573,  470,  377,
         292,  218,  154,  101,  59,   28,   8,    1,    5,    20,   47,   85,   135,  195,  266,  347,
         438,  538,  646,  763,  887,  1017, 1153, 1294, 1440, 1589, 1740, 1894, 2048, 2202, 2356, 2507,
         2656, 2802, 2943, 3079, 3209, 3333, 3450, 3558, 3658, 3749, 3830, 3901, 3961, 4011, 4049, 4076,
         4091, 4095, 4088, 4068, 4037, 3995, 3942, 3878, 3804, 3719, 3626, 3523, 3412, 3293, 3167, 3034,
         2896, 2754, 2607, 2457, 2305, 2151, 1997, 1843, 1690, 1539, 1391, 1247, 1107, 973,  845,  723,
         609,  504,  407,  319,  242,  174,  117,  71,   37,   14,   2,    2,    14,   37,   71,   117,
         174,  242,  319,  407,  504,  609,  723,  845,  973,  1107, 1247, 1391, 1539, 1690, 1842, 1997,
         2151, 2305, 2457, 2607, 2754, 2896, 3034, 3167, 3293, 3412, 3523, 3626, 3719, 3804, 3878, 3942,
         3995, 4037, 4068, 4088, 4095, 4091, 4076, 4049, 4011, 3961, 3901, 3830, 3749, 3658, 3558, 3450,
         3333, 3209, 3079, 2943, 2802, 2656, 2507, 2356, 2202, 2048, 1894, 1740, 1589, 1440, 1294, 1153,
         1017, 887,  763,  646,  538,  438,  347,  266,  195,  135,  85,   47,   20,   5,    1,    8,
         28,   59,   101,  154,  218,  292,  377,  470,  573,  684,  803,  929,  1062, 1200, 1342, 1489,
         1639, 1791, 1945, 2099, 2253, 2406, 2557, 2705, 2849, 2989, 3123, 3251, 3373, 3487, 3592, 3689,
         3777, 3854, 3922, 3979, 4025, 4059, 4082, 4094, 4094, 4082, 4059, 4025, 3979, 3922, 3854, 3777,
         3689, 3592, 3487, 3373, 3251, 3123, 2989, 2849, 2705, 2557, 2406, 2254, 2099, 1945, 1791, 1639,
         1489, 1342, 1200, 1062, 929,  803,  684,  573,  470,  377,  292,  218,  154,  101,  59,   28,
         8,    1,    5,    20,   47,   85,   135,  195,  266,  347,  438,  538,  646,  763,  887,  1017,
         1153, 1294, 1440, 1589, 1740, 1894, 2048, 2202, 2356, 2507, 2656, 2802, 2943, 3079, 3209, 3333,
         3450, 3558, 3658, 3749, 3830, 3901, 3961, 4011, 4049, 4076, 4091, 4095, 4088, 4068, 4037, 3995,
         3942, 3878, 3804, 3719, 3626, 3523, 3412, 3293, 3167, 3034, 2896, 2754, 2607, 2457, 2305, 2151,
         1997, 1843, 1690, 1539, 1391, 1247, 1107, 973,  845,  723,  609,  504,  407,  319,  242,  174,
         117,  71,   37,   14,   2,    2,    14,   37,   71,   117,  174,  242,  319,  407,  504,  609,
         723,  845,  973,  1107, 1247, 1391, 1539, 1690, 1842, 1997, 2151, 2305, 2457, 2607, 2754, 2896,
         3034, 3167, 3293, 3412, 3523, 3626, 3719, 3804, 3878, 3942, 3995, 4037, 4068, 4088, 4095, 4091,
         4076, 4049, 4011, 3961, 3901, 3830, 3749, 3658, 3558, 3450, 3333, 3209, 3079, 2943, 2802, 2656,
         2507, 2356, 2202, 2048, 1894, 1740, 1589, 1440, 1294, 1153, 1017, 887,  763,  646,  538,  438,
         347,  266,  195,  135,  85,   47,   20,   5,    1,    8,    28,   59,   101,  154,  218,  292,
         377,  470,  573,  684,  803,  929,  1062, 1200, 1342, 1489, 1639, 1791, 1945, 2099, 2253, 2406,
         2557, 2705, 2849, 2989, 3123, 3251, 3373, 3487, 3592, 3689, 3777, 3854, 3922, 3979, 4025, 4059,
         4082, 4094, 4094, 4082, 4059, 4025, 3979, 3922, 3854, 3777, 3689, 3592, 3487, 3373, 3252, 3123,
         2989, 2849, 2705, 2557, 2406, 2254, 2099, 1945, 1791, 1639, 1489, 1342, 1200, 1062, 929,  803,
         684,  573,  470,  377,  292,  218,  154,  101,  59,   28,   8,    1,    5,    20,   47,   85,
         135,  195,  266,  347,  438,  538,  646,  763,  887,  1017, 1153, 1294, 1440, 1589, 1740, 1894,
         ]


def calcular_rms(sinal):
    """
    Calcula o valor RMS (Root Mean Square) de um sinal.

    Args:
        sinal (list): Lista contendo as amostras do sinal

    Returns:
        float: Valor RMS do sinal
    """

    # Calcula a soma dos quadrados
    soma_quadrados = sum(x * x for x in sinal)

    # Calcula a média dos quadrados
    media_quadrados = soma_quadrados / len(sinal)

    # Calcula a raiz quadrada da média
    rms = math.sqrt(media_quadrados)

    return rms


def remove_offset(sinal):
    """
    Remove o offset de um sinal calculando a média antes de subtrair.

    Args:
        sinal (list): Lista contendo as amostras do sinal

    Returns:
        list: Sinal com offset removido
    """
    # Calcula a média do sinal
    media = sum(sinal) / len(sinal)

    # Remove o offset subtraindo a média
    return [x - media for x in sinal]


def converter_para_float(sinal):
    """
    Converte um sinal para float.
    """
    return [x / 4095 * 3.3 for x in sinal]


def calcular_fft(sinal, fs=10000):
    """
    Calcula a FFT do sinal usando numpy.

    Args:
        sinal: Array com as amostras do sinal
        fs: Frequência de amostragem (default 10kHz)

    Returns:
        freqs: Array com as frequências
        magnitudes: Array com as magnitudes da FFT
    """

    # Aplica janela de Hanning
    window = np.hanning(len(sinal))
    sinal_windowed = sinal * window

    # Calcula FFT
    fft_result = np.fft.rfft(sinal_windowed)

    # Calcula magnitudes
    magnitudes = np.abs(fft_result)

    # Calcula frequências
    freqs = np.fft.rfftfreq(len(sinal), 1/fs)

    return freqs, magnitudes


def plotar_fft(sinal, fs=10000):
    """
    Plota o gráfico da FFT do sinal.

    Args:
        sinal: Array com as amostras do sinal
        fs: Frequência de amostragem (default 10kHz)
    """

    freqs, magnitudes = calcular_fft(sinal, fs)

    plt.figure(figsize=(12, 6))
    plt.plot(freqs, magnitudes)
    plt.title('Espectro de Frequência')
    plt.xlabel('Frequência (Hz)')
    plt.ylabel('Magnitude')
    plt.grid(True)
    plt.xlim(0, 300)  # Define o limite máximo do eixo x em 300 Hz
    plt.show()


valor_float = converter_para_float(valor)
valor_float_offset = remove_offset(valor_float)


print(len(valor))

# Exemplo de uso
rms_valor = calcular_rms(valor_float_offset)
print(f"Valor RMS do sinal: {rms_valor:.4f}")

plotar_fft(valor_float_offset)
